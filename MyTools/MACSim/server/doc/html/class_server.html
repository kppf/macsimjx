<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>MACSim Server: Server Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>Server Class Reference</h1>A generic, asynchronous pipe server.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="server_8h-source.html">server.h</a>&gt;</code>
<p>
<p>Inheritance diagram for Server:
<p><center><img src="class_server.png" usemap="#Server_map" border="0" alt=""></center>
<map name="Server_map">
<area href="class_thread.html" alt="Thread" shape="rect" coords="49,0,137,24">
<area href="class_config_server.html" alt="ConfigServer" shape="rect" coords="0,112,88,136">
<area href="class_sim_server.html" alt="SimServer" shape="rect" coords="98,112,186,136">
</map>
<a href="class_server-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server.html#a0">Server</a> (const char *p_serverName, const char *p_pipeName, int p_inBuffSize, int p_outBuffSize)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor initialises the server, does not run server thread.  <a href="#a0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server.html#a1">~Server</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor, ensures the server thread has terminated.  <a href="#a1"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server.html#b0">serverFunc</a> (void *request, void *reply)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Server function, should be overridden.  <a href="#b0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server.html#b1">main</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Main thread function, creates and operates the pipe.  <a href="#b1"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Pipe server parameters</div></td></tr>
<tr><td colspan="2"><div class="groupText">Theses parameters are specified by the constructor and used for configuration of the server. <br><br></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server.html#z4_0">m_serverName</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The name of the server.  <a href="#z4_0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server.html#z4_1">m_pipeName</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The name of the pipe.  <a href="#z4_1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server.html#z4_2">m_inBuffSize</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The size of input buffer, in bytes.  <a href="#z4_2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server.html#z4_3">m_outBuffSize</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The size of output buffer, in bytes.  <a href="#z4_3"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Static Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static const int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_server.html#t0">PIPE_TIMEOUT</a> = 1000</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Defines the pipe timeout time in milliseconds.  <a href="#t0"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
A generic, asynchronous pipe server. 
<p>
This class implements a simple generic pipe server, which uses a separate thread to service pipe requests asynchronously. The server expects fixed length input and output buffers, the length of which are specified at construction time. This class should be overridden for general use, redefining the <a class="el" href="class_server.html#b0">serverFunc()</a> method to provide functionality. 
<p>

<p>
Definition at line <a class="el" href="server_8h-source.html#l00033">33</a> of file <a class="el" href="server_8h-source.html">server.h</a>.<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="Server::Server"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">Server::Server           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>p_serverName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>p_pipeName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>p_inBuffSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>p_outBuffSize</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructor initialises the server, does not run server thread. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>p_serverName</em>&nbsp;</td><td>The name of the server, used only to identify the server in an exception message. Used to intialise <a class="el" href="class_server.html#z4_0">m_serverName</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>p_pipeName</em>&nbsp;</td><td>The full path of the named pipe. Used to intialise <a class="el" href="class_server.html#z4_1">m_pipeName</a>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>p_inBuffSize</em>&nbsp;</td><td>The required size of the input buffer, in bytes. Used to initialise <a class="el" href="class_server.html#z4_2">m_inBuffSize</a>. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>p_outBuffSize</em>&nbsp;</td><td>The required size of the output buffer, in bytes. Used to initialise <a class="el" href="class_server.html#z4_3">m_outBuffSize</a>. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="server_8cpp-source.html#l00028">28</a> of file <a class="el" href="server_8cpp-source.html">server.cpp</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="Server::~Server"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">Server::~<a class="el" href="class_server.html">Server</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Destructor, ensures the server thread has terminated. 
<p>

<p>
Definition at line <a class="el" href="server_8cpp-source.html#l00043">43</a> of file <a class="el" href="server_8cpp-source.html">server.cpp</a>.    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b1" doxytag="Server::main"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int Server::main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Main thread function, creates and operates the pipe. 
<p>
The main function runs in a separate thread, created by the parent <a class="el" href="class_thread.html">Thread</a> class. A pipe, with name <a class="el" href="class_server.html#z4_1">m_pipeName</a> is created. The main function then waits for a request on the pipe or the termination event <a class="el" href="class_thread.html#p3">Thread::m_hTerminateEvent</a>. If a request is received it is passed to the <a class="el" href="class_server.html#b0">serverFunc()</a>. The response from <a class="el" href="class_server.html#b0">serverFunc()</a> (in the reply buffer) is sent down the pipe as a reply. 
<p>
Reimplemented from <a class="el" href="class_thread.html#b0">Thread</a>.
<p>
Definition at line <a class="el" href="server_8cpp-source.html#l00053">53</a> of file <a class="el" href="server_8cpp-source.html">server.cpp</a>.    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="Server::serverFunc"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">virtual void Server::serverFunc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void *&nbsp;</td>
          <td class="mdname" nowrap> <em>request</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>reply</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Server function, should be overridden. 
<p>
This function should be overridden by child classes to provide pipe functionality. Data in the request buffer should be used to fill the reply buffer with a suitable response. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>request</em>&nbsp;</td><td>A pointer to the request buffer, this will be <a class="el" href="class_server.html#z4_2">m_inBuffSize</a> bytes long </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reply</em>&nbsp;</td><td>A pointer to the reply buffer, this will be <a class="el" href="class_server.html#z4_3">m_outBuffSize</a> bytes long </td></tr>
  </table>
</dl>

<p>
Reimplemented in <a class="el" href="class_config_server.html#b0">ConfigServer</a>, and <a class="el" href="class_sim_server.html#b0">SimServer</a>.
<p>
Definition at line <a class="el" href="server_8h-source.html#l00046">46</a> of file <a class="el" href="server_8h-source.html">server.h</a>.    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="z4_2" doxytag="Server::m_inBuffSize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_server.html#z4_2">Server::m_inBuffSize</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The size of input buffer, in bytes. 
<p>
Requests to the server should all be of this size. 
<p>
Definition at line <a class="el" href="server_8h-source.html#l00076">76</a> of file <a class="el" href="server_8h-source.html">server.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="z4_3" doxytag="Server::m_outBuffSize"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int <a class="el" href="class_server.html#z4_3">Server::m_outBuffSize</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The size of output buffer, in bytes. 
<p>
Replies from the server should all be of this size. 
<p>
Definition at line <a class="el" href="server_8h-source.html#l00081">81</a> of file <a class="el" href="server_8h-source.html">server.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="z4_1" doxytag="Server::m_pipeName"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">string <a class="el" href="class_server.html#z4_1">Server::m_pipeName</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The name of the pipe. 
<p>
This should contain the full path of the named pipe. 
<p>
Definition at line <a class="el" href="server_8h-source.html#l00071">71</a> of file <a class="el" href="server_8h-source.html">server.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="z4_0" doxytag="Server::m_serverName"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">string <a class="el" href="class_server.html#z4_0">Server::m_serverName</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
The name of the server. 
<p>
This description is used to identify the server in exception messages. 
<p>
Definition at line <a class="el" href="server_8h-source.html#l00066">66</a> of file <a class="el" href="server_8h-source.html">server.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="t0" doxytag="Server::PIPE_TIMEOUT"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">const int <a class="el" href="class_server.html#t0">Server::PIPE_TIMEOUT</a> = 1000<code> [static, protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Defines the pipe timeout time in milliseconds. 
<p>
This value must be specified, but its use does not affect the operation of the server. It is defined here, rather than being hardcoded, for readability. 
<p>
Definition at line <a class="el" href="server_8cpp-source.html#l00022">22</a> of file <a class="el" href="server_8cpp-source.html">server.cpp</a>.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li>MACSim/server/include/<a class="el" href="server_8h-source.html">server.h</a><li>MACSim/server/src/<a class="el" href="server_8cpp-source.html">server.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Wed Mar 9 15:53:43 2005 for MACSim Server by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.1 </small></address>
</body>
</html>
